



<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
    
    <meta charset="utf-8">
    <link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml" />
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    
    <meta itemprop="name" content="Tutorial: Documenting http4k APIs with OpenApi3">
    <meta name="twitter:title" content="Tutorial: Documenting http4k APIs with OpenApi3">
    <meta property="og:title" content="Tutorial: Documenting http4k APIs with OpenApi3" />
    

    
    <meta name="description" content="An overview of the OpenApi3 support available in the http4k library.">
    <meta property="og:description" content="An overview of the OpenApi3 support available in the http4k library." />
    <meta name="twitter:description" content="An overview of the OpenApi3 support available in the http4k library.">
    

    
    <link rel="canonical" href="https://www.http4k.org/tutorials/documenting_apis_with_openapi/">
    

    
    <meta name="author" content="David Denton (@daviddenton), IvanSanchez (@s4nchez)">
    <meta name="twitter:creator" content="David Denton (@daviddenton), IvanSanchez (@s4nchez)">
    

    
    <meta name="lang:clipboard.copy" content="Copy to clipboard">
    
    <meta name="lang:clipboard.copied" content="Copied to clipboard">
    
    <meta name="lang:search.language" content="en">
    
    <meta name="lang:search.pipeline.stopwords" content="True">
    
    <meta name="lang:search.pipeline.trimmer" content="True">
    
    <meta name="lang:search.result.none" content="No matching documents">
    
    <meta name="lang:search.result.one" content="1 matching document">
    
    <meta name="lang:search.result.other" content="# matching documents">
    
    <meta name="lang:search.tokenizer" content="[\s\-]+">
    
    <!-- ****** faviconit.com favicons ****** -->
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="icon" sizes="16x16 32x32 64x64" href="/img/favicon.ico">
    <link rel="icon" type="image/png" sizes="196x196" href="/img/favicon-192.png">
    <link rel="icon" type="image/png" sizes="160x160" href="/img/favicon-160.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/img/favicon-96.png">
    <link rel="icon" type="image/png" sizes="64x64" href="/img/favicon-64.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/img/favicon-16.png">
    <link rel="apple-touch-icon" href="/img/favicon-57.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/img/favicon-114.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/img/favicon-72.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/img/favicon-144.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/img/favicon-60.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/img/favicon-120.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon-76.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/img/favicon-152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/img/favicon-180.png">
    <meta name="msapplication-TileColor" content="#FFFFFF">
    <meta name="msapplication-TileImage" content="/img/favicon-144.png">
    <meta name="msapplication-config" content="/img/browserconfig.xml">
    <!-- ****** faviconit.com favicons ****** -->
    <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.0.4">
    
    
    
    <title>Tutorial: Documenting http4k APIs with OpenApi3</title>
    
    
    
    <link rel="stylesheet" href="../../assets/stylesheets/application.451f80e5.css">
    
    <link rel="stylesheet" href="../../assets/stylesheets/application-palette.22915126.css">
    
    
    
    
    <meta name="theme-color" content="#3f51b5">
    
    
    
    <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
    
    <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
    <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
    
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    <link rel="stylesheet" href="../../css/site.css">
    
    
</head>



<body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="blue">

<svg class="md-svg">
    <defs>
        
        
        <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
    </defs>
</svg>
<input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
<input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
<label class="md-overlay" data-md-component="overlay" for="__drawer"></label>

<a href="../../#tutorial-documenting-http4k-apis-with-openapi3" tabindex="1" class="md-skip">
    Skip to content
</a>


<header class="md-header" data-md-component="header">
    <nav class="md-header-nav md-grid">
        <div class="md-flex">
            <div class="md-flex__cell md-flex__cell--shrink">
                <a href="https://www.http4k.org/" title="http4k"
                   class="md-header-nav__button md-logo">
                    
                    <img src="../../img/logo_1100x200_white_on_blue_trans.png" height="24">
                    
                </a>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
                <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch">
                <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
                    
                    
                    
                        <span class="md-header-nav__parent">
                          Tutorials >
                        </span>
                    
                    
                    Documenting http4k apps with OpenApi3
                    
                </div>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
                
                
                <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
                
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
                
                
            </div>
            
            <div class="md-flex__cell md-flex__cell--shrink">
                <div class="md-header-nav__source">
                    


  


  <a href="https://github.com/http4k/http4k/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

                </div>
            </div>
            
        </div>
    </nav>
</header>

<div class="md-container">
    
    
    
    
    <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
            
            
            <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                    <div class="md-sidebar__inner">
                        <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://www.http4k.org/" title="http4k" class="md-nav__button md-logo">
      
        <img src="../../img/logo_1100x200_white_on_blue_trans.png" width="48" height="48">
      
    </a>
    http4k
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/http4k/http4k/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../rationale/" title="Rationale & Concepts" class="md-nav__link">
      Rationale & Concepts
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../installation/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../quickstart/" title="Getting started" class="md-nav__link">
      Getting started
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Developer Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Developer Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-1" type="checkbox" id="nav-5-1">
    
    <label class="md-nav__link" for="nav-5-1">
      Modules
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-1">
        Modules
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/modules/aws/" title="AWS" class="md-nav__link">
      AWS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/modules/core/" title="Core" class="md-nav__link">
      Core
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/modules/json/" title="JSON handling" class="md-nav__link">
      JSON handling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/modules/clients/" title="HTTP & Websocket clients" class="md-nav__link">
      HTTP & Websocket clients
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/modules/metrics/" title="Metrics" class="md-nav__link">
      Metrics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/modules/multipart/" title="Multipart forms" class="md-nav__link">
      Multipart forms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/modules/resilience/" title="Resilience" class="md-nav__link">
      Resilience
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/modules/servers/" title="Server backend" class="md-nav__link">
      Server backend
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/modules/serverless/" title="Serverless backend" class="md-nav__link">
      Serverless backend
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/modules/templating/" title="Templating" class="md-nav__link">
      Templating
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/modules/contracts/" title="Typesafe contracts (OpenAPI3)" class="md-nav__link">
      Typesafe contracts (OpenAPI3)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/modules/oauth/" title="OAuth" class="md-nav__link">
      OAuth
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/modules/cloud_native/" title="Cloud native Configuration" class="md-nav__link">
      Cloud native Configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/modules/jsonrpc/" title="JSON RPC" class="md-nav__link">
      JSON RPC
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/modules/xml/" title="XML handling" class="md-nav__link">
      XML handling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/modules/hamkrest/" title="Hamkrest" class="md-nav__link">
      Hamkrest
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/modules/approvaltests/" title="Approval Testing" class="md-nav__link">
      Approval Testing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/modules/webdriver/" title="WebDriver" class="md-nav__link">
      WebDriver
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/modules/chaos/" title="Chaos Testing" class="md-nav__link">
      Chaos Testing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/modules/servicevirtualisation/" title="Service Virtualisaion" class="md-nav__link">
      Service Virtualisaion
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/testing/" title="Application Testing" class="md-nav__link">
      Application Testing
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" checked>
    
    <label class="md-nav__link" for="nav-6">
      Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../tdding_http4k/" title="TDDing http4k" class="md-nav__link">
      TDDing http4k
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Documenting http4k apps with OpenApi3
      </label>
    
    <a href="./" title="Documenting http4k apps with OpenApi3" class="md-nav__link md-nav__link--active">
      Documenting http4k apps with OpenApi3
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#about-openapi" title="About OpenApi" class="md-nav__link">
    About OpenApi
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#typesafe-http-contracts-with-http4k-contract" title="Typesafe HTTP contracts with http4k-contract" class="md-nav__link">
    Typesafe HTTP contracts with http4k-contract
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-your-first-endpoint" title="1. Your first endpoint" class="md-nav__link">
    1. Your first endpoint
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-modelling-http-body-messages" title="4. Modelling HTTP body messages" class="md-nav__link">
    4. Modelling HTTP body messages
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wrapping-up" title="Wrapping up..." class="md-nav__link">
    Wrapping up...
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Cookbook
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Cookbook
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cookbook/server_as_a_function/" title="Server as a function" class="md-nav__link">
      Server as a function
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cookbook/client_as_a_function/" title="Client as a function" class="md-nav__link">
      Client as a function
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cookbook/container_integration/" title="Container integration" class="md-nav__link">
      Container integration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cookbook/simple_routing/" title="Simple routing" class="md-nav__link">
      Simple routing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cookbook/service_virtualisation/" title="Service Virtualisation with Servirtium" class="md-nav__link">
      Service Virtualisation with Servirtium
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cookbook/nestable_routes/" title="Nestable routes" class="md-nav__link">
      Nestable routes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cookbook/using_templates/" title="Templating engines" class="md-nav__link">
      Templating engines
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cookbook/request_context/" title="Typesafe RequestContexts" class="md-nav__link">
      Typesafe RequestContexts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cookbook/typesafe_http_requests_with_lenses/" title="Typesafe HTTP requests with lenses" class="md-nav__link">
      Typesafe HTTP requests with lenses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cookbook/custom_json_marshallers/" title="Custom JSON marshallers" class="md-nav__link">
      Custom JSON marshallers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cookbook/html_forms/" title="HTML forms" class="md-nav__link">
      HTML forms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cookbook/multipart_forms/" title="Multipart forms" class="md-nav__link">
      Multipart forms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cookbook/generating_data_classes/" title="Generating data classes for messages" class="md-nav__link">
      Generating data classes for messages
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cookbook/websockets/" title="Websockets" class="md-nav__link">
      Websockets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cookbook/typesafe_http_contracts/" title="Typesafe HTTP contracts" class="md-nav__link">
      Typesafe HTTP contracts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cookbook/structured_logging_with_events/" title="Structured Logging with Events" class="md-nav__link">
      Structured Logging with Events
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cookbook/basic_oauth_authorization_server/" title="Basic OAuth Server configuration" class="md-nav__link">
      Basic OAuth Server configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cookbook/custom_oauth_provider/" title="Custom OAuth Provider configuration" class="md-nav__link">
      Custom OAuth Provider configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cookbook/principal_lookup/" title="Principal lookup" class="md-nav__link">
      Principal lookup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cookbook/monitoring/" title="Monitoring http4k" class="md-nav__link">
      Monitoring http4k
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cookbook/record_and_replay/" title="Recording/replaying HTTP traffic" class="md-nav__link">
      Recording/replaying HTTP traffic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cookbook/test_driven_apps/" title="Test driven apps" class="md-nav__link">
      Test driven apps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cookbook/nanoservices/" title="Nanoservices" class="md-nav__link">
      Nanoservices
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../performance/" title="Performance" class="md-nav__link">
      Performance
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../in_action/" title="In action" class="md-nav__link">
      In action
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      Blog
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        Blog
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../blog/meet_http4k/" title="Meet http4k" class="md-nav__link">
      Meet http4k
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../blog/typesafe_websockets/" title="Typesafe Websockets" class="md-nav__link">
      Typesafe Websockets
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../support/" title="Getting Support" class="md-nav__link">
      Getting Support
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../contributing/" title="Contribute/Support http4k" class="md-nav__link">
      Contribute/Support http4k
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../api/" title="API docs" class="md-nav__link">
      API docs
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../changelog/" title="Changelog" class="md-nav__link">
      Changelog
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../faq/" title="FAQ" class="md-nav__link">
      FAQ
    </a>
  </li>

    
  </ul>
</nav>
                    </div>
                </div>
            </div>
            
            
            <div class="md-content">
                <article class="md-content__inner md-typeset">
                    
                    
                    <a href="https://github.com/http4k/http4k/edit/master/src/docs/tutorials/documenting_apis_with_openapi/index.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                    
                    
                    <h1 id="tutorial-documenting-http4k-apis-with-openapi3">Tutorial: Documenting http4k APIs with OpenApi3</h1>
<p>This post describes <strong><a href="http://github.com/http4k/http4k">http4k</a></strong> support for fully describing and securing HTTP endpoints using version 3 of the <strong><a href="https://www.openapis.org/">OpenApi</a></strong> specification, providing typesafe JSON-schema documentation for messages and automatically validating incoming HTTP traffic.</p>
<h3 id="about-openapi">About OpenApi</h3>
<p>In microservice environments, some of the biggest challenges exist around the communications between processes that simply aren't present when you're doing monolith-based development. This manifests in many different operational ways such as monitoring, discovery and fault tolerance, but one of the key aspects is communicating the the HTTP contract provided by a particular service.</p>
<p>There have been various efforts to standardise these aspects, and one of the most popular is <strong><a href="https://www.openapis.org/">OpenApi</a></strong>, which grew out of the original <strong><a href="https://swagger.io">Swagger</a></strong> project. There are 3 key advantages to OpenApi:</p>
<ol>
<li>It provides a standardised way of documenting APIs, including routes, parameter optionality and format, security models and JSON Schema breakdown of JSON messages. It has standardised support from cloud providers such as <strong><a href="https://cloud.google.com/endpoints/docs/openapi/">Google Cloud Endpoints</a></strong> and <strong><a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-swagger-extensions.html">AWS API Gateway</a></strong>.</li>
<li>The OpenApi <strong><a href="https://www.http4k.org/openapi3/">UI</a></strong> allows a very simple and developer-focused way of exploring and interacting with HTTP services from a browser environment.</li>
<li>It is cross-platform and has good tooling support. Using <strong><a href="https://openapi-generator.tech">OpenApi Generators</a></strong>, a specification document can be used to generate HTTP server stubs and working HTTP clients in a variety of languages, thus reducing integration efforts.</li>
</ol>
<h3 id="typesafe-http-contracts-with-http4k-contract">Typesafe HTTP contracts with http4k-contract</h3>
<p>http4k has supported generating version 2 of <strong><a href="https://www.openapis.org/">OpenApi</a></strong> docs since all the way back in 2017 (v1.16) via it's <code>http4k-contract</code> module, and after a couple of releases ironing out the niggles (and some amazing help from the community), the team is now happy to announce OpenApi3 support with the release of http4k version 3.179.0.</p>
<p>In line with the overall <strong><a href="/rationale">ethos of the project</a></strong>, http4k OpenApi support is done entirely through code and in a typesafe and refactorable way. This is somewhat of a departure from how most other libraries have implemented OpenApi (where often annotations and other compile-time magic are used) and means that in http4k the spec defined in code is the same one that is used to generate the API documentation and the same one used to validate incoming HTTP messages, meaning that it can never go stale. This focus on runtime code also allows for dynamic behaviours which would be very difficult to replicate at compile-time.</p>
<p>Out of the box, <code>http4k-contract</code> the module now provides the following features when configured for OpenApi3:</p>
<ol>
<li><strong>Automatic generation of route documentation</strong> in OpenApi v3 format, including the JSON Schema models for example incoming and outgoing messages (which arguably provide at least 50% of the value of using OpenApi).</li>
<li><strong>Complete auto-validation</strong> of the defined HTTP contract through the typesafe http4k Lens mechanism - violations are automatically detected and a BAD_REQUEST returned to the caller. This means that zero custom validation code is required to clutter up your routing layer and you can concentrate on working with meaningful domain types instead of primitives.</li>
<li><strong>Support/implementation of all defined OpenApi security models</strong> at both a global and per-route scope - BearerToken, ApiKey, OAuth and BasicAuth, although you can of course define and use custom implementations.</li>
<li><strong>Simple API for defining custom <a href="https://swagger.io/docs/specification/openapi-extensions/">OpenApi extensions</a></strong> to extend the outputted specification document, for example using http4k in with <strong><a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-swagger-extensions.html">AWS API Gateway</a></strong> or <strong><a href="https://cloud.google.com/endpoints/docs/openapi/">Google Cloud Endpoints</a></strong></li>
</ol>
<p>So, how does we do all this using the http4k API? Let's find out with a worked example. </p>
<h3 id="1-your-first-endpoint">1. Your first endpoint</h3>
<p>After importing the <code>http4k-core</code> and <code>http4k-contract</code> dependencies into your project, we can write a new endpoint aka <code>ContractRoute</code>. The first thing to note is that we will be using a slightly different routing DSL the standard http4k one, one which provides a richer way to document endpoints - but don't worry - at it's core it utilises the same simple http4k building blocks of <code>HttpHandler</code> and <code>Filter</code>, as well as leveraging the <strong><a href="https://www.http4k.org/guide/modules/core/#typesafe-parameter-destructuringconstruction-of-http-messages-with-lenses">http4k Lens API</a></strong> to automatically extract and convert incoming  parameters into richer domain types. As ever, routes can (and should) be written and testing independently, which aids code decomposition and reuse. </p>
<p>In this simple example, we're going to use a path with two dynamic parameters; <code>name</code> - a String, and the Integer <code>age</code> - which will be extracted and "mapped" into the constructor of a simple validated domain wrapper type. If the basic format of the path or the values for these path parameters cannot be extracted correctly, the endpoint fails to match and is skipped - this allows for several different variations of the same URI path signature to co-exist. </p>
<p>Once the values have been extracted, they are passed as arguments to a function which will return a pre-configured <code>HttpHandler</code> for that call:</p>
<div class="codehilite"><pre><span></span><code><span class="k">package</span> <span class="nn">tutorials.documenting_apis_with_openapi</span>

<span class="k">import</span> <span class="nn">org.http4k.contract.ContractRoute</span>
<span class="k">import</span> <span class="nn">org.http4k.contract.div</span>
<span class="k">import</span> <span class="nn">org.http4k.core.HttpHandler</span>
<span class="k">import</span> <span class="nn">org.http4k.core.Method.GET</span>
<span class="k">import</span> <span class="nn">org.http4k.core.Request</span>
<span class="k">import</span> <span class="nn">org.http4k.core.Response</span>
<span class="k">import</span> <span class="nn">org.http4k.core.Status.Companion.OK</span>
<span class="k">import</span> <span class="nn">org.http4k.lens.Path</span>
<span class="k">import</span> <span class="nn">org.http4k.lens.int</span>

<span class="k">data</span> <span class="k">class</span> <span class="nc">Age</span><span class="p">(</span><span class="k">val</span> <span class="py">value</span><span class="p">:</span> <span class="n">Int</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">init</span> <span class="p">{</span>
        <span class="n">require</span><span class="p">(</span><span class="n">value</span> <span class="p">&gt;=</span> <span class="m">0</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fun</span> <span class="nf">basicHandler</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="n">String</span><span class="p">,</span> <span class="n">age</span><span class="p">:</span> <span class="n">Age</span><span class="p">):</span> <span class="n">HttpHandler</span> <span class="p">=</span> <span class="p">{</span> <span class="n">req</span><span class="p">:</span> <span class="n">Request</span> <span class="p">-&gt;</span>
    <span class="k">val</span> <span class="py">beverage</span> <span class="p">=</span> <span class="k">if</span> <span class="p">(</span><span class="n">age</span><span class="p">.</span><span class="n">value</span> <span class="p">&gt;=</span> <span class="m">18</span><span class="p">)</span> <span class="s">&quot;beer&quot;</span> <span class="k">else</span> <span class="s">&quot;lemonade&quot;</span>
    <span class="n">Response</span><span class="p">(</span><span class="n">OK</span><span class="p">).</span><span class="n">body</span><span class="p">(</span><span class="s">&quot;Hello $name, would you like some $beverage?&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">val</span> <span class="py">basicRoute</span><span class="p">:</span> <span class="n">ContractRoute</span> <span class="p">=</span> <span class="s">&quot;/greet&quot;</span> <span class="p">/</span> <span class="n">Path</span><span class="p">.</span><span class="n">of</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">)</span> <span class="p">/</span> <span class="n">Path</span><span class="p">.</span><span class="n">int</span><span class="p">().</span><span class="n">map</span><span class="p">(</span><span class="o">::</span><span class="n">Age</span><span class="p">).</span><span class="n">of</span><span class="p">(</span><span class="s">&quot;age&quot;</span><span class="p">)</span> <span class="n">bindContract</span> <span class="n">GET</span> <span class="n">to</span> <span class="o">::</span><span class="n">basicHandler</span><span class="err">```</span>

<span class="n">And</span> <span class="n">here</span><span class="err">&#39;</span><span class="n">s</span> <span class="n">a</span> <span class="n">unit</span> <span class="n">test</span> <span class="k">for</span> <span class="n">that</span> <span class="n">endpoint</span> <span class="p">-</span> <span class="n">the</span> <span class="n">good</span> <span class="n">news</span> <span class="k">is</span> <span class="n">that</span> <span class="n">it</span><span class="err">&#39;</span><span class="n">s</span> <span class="n">no</span> <span class="n">more</span> <span class="n">complex</span> <span class="n">than</span> <span class="n">a</span> <span class="n">standard</span> <span class="n">http4k</span> <span class="n">unit</span> <span class="n">test</span> <span class="n">because</span> <span class="n">`ContractRoute`</span> <span class="k">is</span> <span class="n">also</span> <span class="n">an</span> <span class="n">`HttpHandler`</span> <span class="n">so</span> <span class="n">can</span> <span class="n">just</span> <span class="n">be</span> <span class="n">invoked</span> <span class="k">as</span> <span class="n">a</span> <span class="n">function</span><span class="p">.</span> <span class="n">Here</span><span class="p">,</span> <span class="n">we</span><span class="err">&#39;</span><span class="n">re</span> <span class="n">also</span> <span class="n">leveraging</span> <span class="n">the</span> <span class="n">`http4k-testing-hamkrest`</span> <span class="n">module</span> <span class="n">to</span> <span class="n">supply</span> <span class="p">**[</span><span class="n">Hamkrest</span><span class="p">]**</span> <span class="n">Matchers</span> <span class="k">for</span> <span class="n">validating</span> <span class="n">the</span> <span class="n">response</span> <span class="n">message</span><span class="p">:</span>

<span class="err">```</span><span class="n">kotlin</span>
<span class="k">package</span> <span class="nn">tutorials.documenting_apis_with_openapi</span>

<span class="k">import</span> <span class="nn">com.natpryce.hamkrest.assertion.assertThat</span>
<span class="k">import</span> <span class="nn">org.http4k.core.Method.GET</span>
<span class="k">import</span> <span class="nn">org.http4k.core.Request</span>
<span class="k">import</span> <span class="nn">org.http4k.hamkrest.hasBody</span>
<span class="k">import</span> <span class="nn">org.junit.jupiter.api.Test</span>

<span class="k">class</span> <span class="nc">BasicGreetingRouteTest</span> <span class="p">{</span>
    <span class="n">@Test</span>
    <span class="k">fun</span> <span class="nf">`greets an adult`</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">assertThat</span><span class="p">(</span><span class="n">basicRoute</span><span class="p">(</span><span class="n">Request</span><span class="p">(</span><span class="n">GET</span><span class="p">,</span> <span class="s">&quot;/greet/Bob/21&quot;</span><span class="p">)),</span> <span class="n">hasBody</span><span class="p">(</span><span class="s">&quot;Hello Bob, would you like some beer?&quot;</span><span class="p">))</span>
    <span class="p">}</span>
<span class="p">}</span><span class="err">```</span>

<span class="err">###</span> <span class="m">2.</span> <span class="n">Defining</span> <span class="n">an</span> <span class="n">HTTP</span> <span class="n">contract</span>
<span class="n">Now</span> <span class="n">that</span> <span class="n">we</span><span class="err">&#39;</span><span class="n">ve</span> <span class="n">got</span> <span class="n">our</span> <span class="n">endpoint</span><span class="p">,</span> <span class="n">we</span> <span class="n">want</span> <span class="n">to</span> <span class="n">be</span> <span class="n">able</span> <span class="n">to</span> <span class="n">actually</span> <span class="n">serve</span> <span class="n">it</span> <span class="n">with</span> <span class="n">the</span> <span class="p">**[</span><span class="n">OpenApi</span><span class="p">]**</span> <span class="n">documentation</span><span class="p">.</span> <span class="n">For</span> <span class="n">contract</span><span class="p">-</span><span class="n">based</span> <span class="n">routing</span><span class="p">,</span> <span class="n">we</span> <span class="n">use</span> <span class="n">the</span> <span class="err">`</span><span class="n">contract</span> <span class="p">{}</span><span class="err">`</span> <span class="n">routing</span> <span class="n">DSL</span> <span class="n">which</span> <span class="n">allows</span> <span class="n">us</span> <span class="n">to</span> <span class="n">specify</span> <span class="n">a</span> <span class="n">richer</span> <span class="k">set</span> <span class="n">of</span> <span class="n">details</span> <span class="n">about</span> <span class="n">the</span> <span class="n">API</span> <span class="n">definition</span><span class="p">,</span> <span class="n">but</span> <span class="n">exposes</span> <span class="n">exactly</span> <span class="n">the</span> <span class="n">same</span> <span class="n">API</span> <span class="n">semantics</span> <span class="k">as</span> <span class="n">the</span> <span class="n">standard</span> <span class="err">`</span><span class="n">routes</span><span class="p">()</span><span class="err">`</span> <span class="n">block</span> <span class="p">-</span> <span class="n">it</span> <span class="k">is</span> <span class="n">also</span> <span class="n">an</span> <span class="n">`HttpHandler`</span> <span class="n">and</span> <span class="n">can</span> <span class="n">therefore</span> <span class="n">be</span> <span class="n">composed</span> <span class="n">together</span> <span class="n">to</span> <span class="n">form</span> <span class="n">standard</span> <span class="n">route</span><span class="p">-</span><span class="n">matching</span> <span class="n">trees</span><span class="p">.</span>

<span class="n">For</span> <span class="n">rendering</span> <span class="n">the</span> <span class="n">API</span> <span class="n">documentation</span><span class="p">,</span> <span class="n">we</span> <span class="n">configure</span> <span class="n">an</span> <span class="n">`OpenApi`</span> <span class="k">object</span><span class="p">,</span> <span class="n">supplying</span> <span class="n">a</span> <span class="n">standard</span> <span class="n">http4k</span> <span class="n">JSON</span> <span class="n">adapter</span> <span class="n">instance</span> <span class="p">-</span> <span class="n">the</span> <span class="n">recommended</span> <span class="n">one</span> <span class="n">to</span> <span class="n">use</span> <span class="k">is</span> <span class="n">`Jackson`</span> <span class="n">from</span> <span class="n">the</span> <span class="n">`http4k-format-jackson`</span> <span class="n">module</span><span class="p">,</span> <span class="n">so</span> <span class="n">we</span><span class="err">&#39;</span><span class="n">ll</span> <span class="n">need</span> <span class="n">to</span> <span class="k">import</span> <span class="nn">that</span> <span class="n">module</span> <span class="n">into</span> <span class="n">our</span> <span class="n">project</span> <span class="k">as</span> <span class="n">well</span><span class="p">.</span>

<span class="n">Whilst</span> <span class="n">all</span> <span class="n">of</span> <span class="n">the</span> <span class="n">settings</span> <span class="n">used</span> <span class="k">in</span> <span class="k">this</span> <span class="n">DSL</span> <span class="n">above</span> <span class="n">are</span> <span class="n">optional</span> <span class="p">(</span><span class="n">and</span> <span class="n">default</span> <span class="n">to</span> <span class="n">sensible</span> <span class="n">values</span> <span class="k">if</span> <span class="n">not</span> <span class="n">overridden</span><span class="p">),</span> <span class="n">here</span> <span class="n">we</span> <span class="n">are</span> <span class="n">updating</span> <span class="n">the</span> <span class="n">URL</span> <span class="k">where</span> <span class="n">the</span> <span class="n">OpenApi</span> <span class="n">spec</span> <span class="k">is</span> <span class="n">served</span> <span class="n">and</span> <span class="n">supplying</span> <span class="n">an</span> <span class="n">instance</span> <span class="n">of</span> <span class="n">`Security`</span> <span class="n">that</span> <span class="n">we</span> <span class="n">will</span> <span class="n">use</span> <span class="n">to</span> <span class="n">protect</span> <span class="n">our</span> <span class="n">routes</span> <span class="p">(</span><span class="n">more</span> <span class="n">about</span> <span class="n">that</span> <span class="n">later</span><span class="p">).</span> 

<span class="err">```</span><span class="n">kotlin</span>
<span class="k">package</span> <span class="nn">tutorials.documenting_apis_with_openapi</span>

<span class="k">import</span> <span class="nn">org.http4k.contract.contract</span>
<span class="k">import</span> <span class="nn">org.http4k.contract.openapi.ApiInfo</span>
<span class="k">import</span> <span class="nn">org.http4k.contract.openapi.v3.OpenApi3</span>
<span class="k">import</span> <span class="nn">org.http4k.contract.security.BasicAuthSecurity</span>
<span class="k">import</span> <span class="nn">org.http4k.core.Credentials</span>
<span class="k">import</span> <span class="nn">org.http4k.core.HttpHandler</span>
<span class="k">import</span> <span class="nn">org.http4k.format.Jackson</span>
<span class="k">import</span> <span class="nn">org.http4k.server.Undertow</span>
<span class="k">import</span> <span class="nn">org.http4k.server.asServer</span>

<span class="k">fun</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">val</span> <span class="py">http</span><span class="p">:</span> <span class="n">HttpHandler</span> <span class="p">=</span> <span class="n">contract</span> <span class="p">{</span>
        <span class="n">renderer</span> <span class="p">=</span> <span class="n">OpenApi3</span><span class="p">(</span><span class="n">ApiInfo</span><span class="p">(</span><span class="s">&quot;my secure api&quot;</span><span class="p">,</span> <span class="s">&quot;v1.0&quot;</span><span class="p">,</span> <span class="s">&quot;API description&quot;</span><span class="p">),</span> <span class="n">Jackson</span><span class="p">)</span>
        <span class="n">descriptionPath</span> <span class="p">=</span> <span class="s">&quot;/api/swagger.json&quot;</span>
        <span class="n">security</span> <span class="p">=</span> <span class="n">BasicAuthSecurity</span><span class="p">(</span><span class="s">&quot;realm&quot;</span><span class="p">,</span> <span class="n">Credentials</span><span class="p">(</span><span class="s">&quot;user&quot;</span><span class="p">,</span> <span class="s">&quot;password&quot;</span><span class="p">))</span>
        <span class="n">routes</span> <span class="p">+=</span> <span class="n">basicRoute</span>
    <span class="p">}</span>

    <span class="n">http</span><span class="p">.</span><span class="n">asServer</span><span class="p">(</span><span class="n">Undertow</span><span class="p">(</span><span class="m">9000</span><span class="p">)).</span><span class="n">start</span><span class="p">()</span>
<span class="p">}</span><span class="err">```</span>

<span class="n">Now</span> <span class="n">we</span><span class="err">&#39;</span><span class="n">ve</span> <span class="n">got</span> <span class="n">a</span> <span class="n">complete</span> <span class="n">contract</span><span class="p">,</span> <span class="n">we</span> <span class="n">can</span> <span class="n">simply</span> <span class="n">start</span> <span class="n">the</span> <span class="n">server</span> <span class="n">and</span> <span class="n">browse</span> <span class="n">to</span> <span class="err">`</span><span class="n">http</span><span class="p">:</span><span class="c1">//localhost:9000/api/swagger.json` to see the basic API spec in the OpenApi UI (or see the online version **&lt;a target=&quot;_blank&quot; href=&quot;https://www.http4k.org/openapi3/?url=https%3A%2F%2Fraw.githubusercontent.com%2Fhttp4k%2Fhttp4k%2Fmaster%2Fsrc%2Fdocs%2Ftutorials%2Fdocumenting_apis_with_openapi%2F2_openapi.json&quot;&gt;here&lt;/a&gt;**) to see how the endpoint contract looks and how the process of supplying credentials is done through the UI by clicking `Authorize`. </span>

<span class="n">This</span> <span class="n">covers</span> <span class="n">the</span> <span class="n">very</span> <span class="n">basics</span> <span class="n">of</span> <span class="n">generating</span> <span class="n">API</span> <span class="n">docs</span><span class="p">,</span> <span class="n">but</span> <span class="n">there</span> <span class="k">is</span> <span class="n">still</span> <span class="n">a</span> <span class="n">lot</span> <span class="n">more</span> <span class="n">http4k</span> <span class="n">can</span> <span class="k">do</span> <span class="k">for</span> <span class="n">us</span><span class="p">...</span>

<span class="err">###</span> <span class="m">3.</span> <span class="n">Auto</span><span class="p">-</span><span class="n">validating</span> <span class="n">incoming</span> <span class="n">HTTP</span> <span class="n">messages</span>
<span class="n">For</span> <span class="n">a</span> <span class="n">better</span> <span class="n">standard</span> <span class="n">of</span> <span class="n">API</span> <span class="n">docs</span><span class="p">,</span> <span class="n">we</span> <span class="n">should</span> <span class="n">add</span> <span class="n">more</span> <span class="n">details</span> <span class="n">to</span> <span class="n">the</span> <span class="n">endpoint</span> <span class="n">definition</span><span class="p">.</span> <span class="n">The</span> <span class="n">OpenAPI</span> <span class="n">spec</span> <span class="n">allows</span> <span class="n">us</span> <span class="n">to</span> <span class="n">add</span> <span class="k">this</span> <span class="n">detail</span><span class="p">,</span> <span class="n">but</span> <span class="k">this</span> <span class="n">normally</span> <span class="n">comes</span> <span class="n">with</span> <span class="n">a</span> <span class="n">maintenance</span> <span class="n">cost</span> <span class="p">-</span> <span class="n">especially</span> <span class="k">when</span> <span class="n">the</span> <span class="n">documentation</span> <span class="k">is</span> <span class="n">static</span> <span class="n">or</span> <span class="n">disparate</span> <span class="n">from</span> <span class="n">the</span> <span class="n">location</span> <span class="n">of</span> <span class="n">the</span> <span class="n">actual</span> <span class="n">code</span> <span class="n">serving</span> <span class="n">requests</span><span class="p">,</span> <span class="n">and</span> <span class="n">we</span> <span class="n">want</span> <span class="n">to</span> <span class="n">minimise</span> <span class="n">the</span> <span class="n">risk</span> <span class="n">of</span> <span class="n">stale</span> <span class="n">documentation</span><span class="p">.</span>
<span class="n">In</span> <span class="n">http4k</span><span class="p">,</span> <span class="n">the</span> <span class="n">extended</span> <span class="n">contract</span> <span class="n">metadata</span> <span class="k">is</span> <span class="n">kept</span> <span class="n">close</span> <span class="n">to</span> <span class="n">the</span> <span class="n">endpoint</span> <span class="n">code</span> <span class="n">and</span> <span class="n">mostly</span> <span class="n">type</span><span class="p">-</span><span class="n">checked</span> <span class="k">by</span> <span class="n">the</span> <span class="n">compiler</span><span class="p">,</span> <span class="n">so</span> <span class="k">this</span> <span class="n">threat</span> <span class="k">is</span> <span class="n">minimised</span> <span class="k">as</span> <span class="n">far</span> <span class="k">as</span> <span class="n">practical</span><span class="p">.</span> 

<span class="n">Metadata</span> <span class="k">for</span> <span class="n">endpoints</span> <span class="n">can</span> <span class="n">be</span> <span class="n">supplied</span> <span class="n">via</span> <span class="n">inserting</span> <span class="n">a</span> <span class="err">`</span><span class="n">meta</span> <span class="p">{}</span><span class="err">`</span> <span class="n">DSL</span> <span class="n">block</span><span class="p">,</span> <span class="n">which</span> <span class="n">contains</span> <span class="n">a</span> <span class="n">mixture</span> <span class="n">of</span> <span class="m">2</span> <span class="n">main</span> <span class="n">types</span> <span class="n">of</span> <span class="n">property</span><span class="p">:</span> 

<span class="m">1.</span> <span class="p">**</span><span class="n">Informational</span><span class="p">**</span> <span class="n">properties</span> <span class="p">-</span> <span class="n">such</span> <span class="k">as</span> <span class="n">`summary`</span><span class="p">,</span> <span class="n">`description`</span> <span class="n">and</span> <span class="n">`tags`</span> <span class="n">simply</span> <span class="n">improve</span> <span class="n">the</span> <span class="n">experience</span> <span class="n">of</span> <span class="n">the</span> <span class="n">user</span> <span class="n">of</span> <span class="n">the</span> <span class="n">UI</span><span class="p">.</span>
<span class="m">1.</span> <span class="p">**</span><span class="n">Contractual</span><span class="p">**</span> <span class="n">properties</span> <span class="n">define</span> <span class="n">parameters</span> <span class="n">using</span> <span class="n">the</span> <span class="p">**[</span><span class="n">http4k</span> <span class="n">Lens</span> <span class="n">API</span><span class="p">]**</span> <span class="p">(</span><span class="k">in</span> <span class="n">the</span> <span class="n">same</span> <span class="n">way</span> <span class="k">as</span> <span class="n">we</span> <span class="n">used</span> <span class="k">for</span> <span class="n">the</span> <span class="n">path</span><span class="p">)</span> <span class="k">for</span> <span class="n">the</span> <span class="n">`Query`</span><span class="p">,</span> <span class="n">`Header`</span> <span class="n">or</span> <span class="n">`Body`</span> <span class="n">parts</span> <span class="n">of</span> <span class="n">the</span> <span class="n">request</span><span class="p">.</span> <span class="n">Once</span> <span class="n">added</span> <span class="n">to</span> <span class="n">the</span> <span class="n">contract</span><span class="p">,</span> <span class="n">these</span> <span class="n">items</span> <span class="n">will</span> <span class="n">also</span> <span class="n">be</span> <span class="n">auto</span><span class="p">-</span><span class="n">validated</span> <span class="k">for</span> <span class="n">form</span> <span class="n">and</span> <span class="n">presence</span> <span class="n">before</span> <span class="n">the</span> <span class="n">contract</span> <span class="n">HttpHandler</span> <span class="k">is</span> <span class="n">invoked</span><span class="p">,</span> <span class="n">thus</span> <span class="n">eliminating</span> <span class="n">the</span> <span class="n">need</span> <span class="k">for</span> <span class="n">any</span> <span class="n">custom</span> <span class="n">validation</span> <span class="n">code</span> <span class="n">to</span> <span class="n">be</span> <span class="n">written</span><span class="p">.</span> <span class="n">We</span> <span class="n">can</span> <span class="n">then</span> <span class="n">use</span> <span class="n">the</span> <span class="n">same</span> <span class="n">lenses</span> <span class="n">to</span> <span class="n">confidently</span> <span class="n">extract</span> <span class="n">those</span> <span class="n">values</span> <span class="n">inside</span> <span class="n">our</span> <span class="n">HttpHandler</span> <span class="n">code</span><span class="p">.</span>

<span class="n">Let</span><span class="err">&#39;</span><span class="n">s</span> <span class="n">demonstrate</span> <span class="k">by</span> <span class="n">writing</span> <span class="n">a</span> <span class="n">slightly</span> <span class="n">different</span> <span class="n">version</span> <span class="n">of</span> <span class="n">the</span> <span class="n">same</span> <span class="n">endpoint</span><span class="p">,</span> <span class="n">but</span> <span class="n">move</span> <span class="n">`age`</span> <span class="n">to</span> <span class="n">be</span> <span class="n">a</span> <span class="n">required</span> <span class="n">query</span> <span class="n">parameter</span><span class="p">,</span> <span class="n">and</span> <span class="n">also</span> <span class="n">add</span> <span class="n">the</span> <span class="n">option</span> <span class="n">to</span> <span class="k">override</span> <span class="n">the</span> <span class="n">`drink`</span> <span class="n">we</span> <span class="n">offer</span><span class="p">:</span>

<span class="err">```</span><span class="n">kotlin</span>
<span class="k">package</span> <span class="nn">tutorials.documenting_apis_with_openapi</span>

<span class="k">import</span> <span class="nn">org.http4k.contract.ContractRoute</span>
<span class="k">import</span> <span class="nn">org.http4k.contract.Tag</span>
<span class="k">import</span> <span class="nn">org.http4k.contract.div</span>
<span class="k">import</span> <span class="nn">org.http4k.contract.meta</span>
<span class="k">import</span> <span class="nn">org.http4k.core.ContentType.Companion.TEXT_PLAIN</span>
<span class="k">import</span> <span class="nn">org.http4k.core.HttpHandler</span>
<span class="k">import</span> <span class="nn">org.http4k.core.Method.GET</span>
<span class="k">import</span> <span class="nn">org.http4k.core.Request</span>
<span class="k">import</span> <span class="nn">org.http4k.core.Response</span>
<span class="k">import</span> <span class="nn">org.http4k.core.Status.Companion.OK</span>
<span class="k">import</span> <span class="nn">org.http4k.lens.Path</span>
<span class="k">import</span> <span class="nn">org.http4k.lens.Query</span>
<span class="k">import</span> <span class="nn">org.http4k.lens.int</span>

<span class="k">data</span> <span class="k">class</span> <span class="nc">Drink</span><span class="p">(</span><span class="k">val</span> <span class="py">name</span><span class="p">:</span> <span class="n">String</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">init</span> <span class="p">{</span>
        <span class="n">require</span><span class="p">(</span><span class="n">name</span><span class="p">.</span><span class="n">isNotEmpty</span><span class="p">())</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fun</span> <span class="nf">Greetings</span><span class="p">():</span> <span class="n">ContractRoute</span> <span class="p">{</span>
    <span class="k">val</span> <span class="py">age</span> <span class="p">=</span> <span class="n">Query</span><span class="p">.</span><span class="n">int</span><span class="p">().</span><span class="n">map</span><span class="p">(</span><span class="o">::</span><span class="n">Age</span><span class="p">).</span><span class="n">required</span><span class="p">(</span><span class="s">&quot;age&quot;</span><span class="p">,</span> <span class="s">&quot;Your age&quot;</span><span class="p">)</span>
    <span class="k">val</span> <span class="py">favouriteDrink</span> <span class="p">=</span> <span class="n">Query</span><span class="p">.</span><span class="n">map</span><span class="p">(</span><span class="o">::</span><span class="n">Drink</span><span class="p">).</span><span class="n">optional</span><span class="p">(</span><span class="s">&quot;drink&quot;</span><span class="p">,</span> <span class="s">&quot;Your favourite beverage&quot;</span><span class="p">)</span>

    <span class="k">fun</span> <span class="nf">handler</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="n">String</span><span class="p">):</span> <span class="n">HttpHandler</span> <span class="p">=</span> <span class="p">{</span> <span class="n">req</span><span class="p">:</span> <span class="n">Request</span> <span class="p">-&gt;</span>
        <span class="k">val</span> <span class="py">drinkToOffer</span><span class="p">:</span> <span class="n">Drink</span><span class="p">?</span> <span class="p">=</span> <span class="n">favouriteDrink</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
        <span class="k">val</span> <span class="py">beverage</span><span class="p">:</span> <span class="n">String</span> <span class="p">=</span> <span class="n">drinkToOffer</span><span class="o">?.</span><span class="n">name</span> <span class="o">?:</span> <span class="k">if</span> <span class="p">(</span><span class="n">age</span><span class="p">(</span><span class="n">req</span><span class="p">).</span><span class="n">value</span> <span class="p">&gt;=</span> <span class="m">18</span><span class="p">)</span> <span class="s">&quot;beer&quot;</span> <span class="k">else</span> <span class="s">&quot;lemonade&quot;</span>
        <span class="n">Response</span><span class="p">(</span><span class="n">OK</span><span class="p">).</span><span class="n">body</span><span class="p">(</span><span class="s">&quot;Hello $name, would you like some $beverage?&quot;</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="s">&quot;/greet&quot;</span> <span class="p">/</span> <span class="n">Path</span><span class="p">.</span><span class="n">of</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">,</span> <span class="s">&quot;Your name&quot;</span><span class="p">)</span> <span class="n">meta</span> <span class="p">{</span>
        <span class="n">summary</span> <span class="p">=</span> <span class="s">&quot;Send greetings&quot;</span>
        <span class="n">description</span> <span class="p">=</span> <span class="s">&quot;Greets the stupid human by offering them a beverage suitable for their age&quot;</span>
        <span class="n">tags</span> <span class="p">+=</span> <span class="n">Tag</span><span class="p">(</span><span class="s">&quot;query&quot;</span><span class="p">)</span>
        <span class="n">queries</span> <span class="p">+=</span> <span class="n">favouriteDrink</span>
        <span class="n">queries</span> <span class="p">+=</span> <span class="n">age</span>
        <span class="n">produces</span> <span class="p">+=</span> <span class="n">TEXT_PLAIN</span>
        <span class="n">returning</span><span class="p">(</span><span class="n">OK</span> <span class="n">to</span> <span class="s">&quot;A successful offer of a drink to the lowly meatbag.&quot;</span><span class="p">)</span>
    <span class="p">}</span> <span class="n">bindContract</span> <span class="n">GET</span> <span class="n">to</span> <span class="o">::</span><span class="n">handler</span>
<span class="p">}</span>
</code></pre></div>


<p>If we then add the <code>Greetings</code> endpoint to the contract and make a call omitting <code>age</code>...</p>
<p><code>http://localhost:9000/greet/Bob?drink=cola</code></p>
<p>... the contract validation will fail and a HTTP Bad Request (400) returned to the client with a JSON body describing the error:</p>
<div class="codehilite"><pre><span></span><code><span class="n">HTTP</span><span class="p">/</span><span class="m">1.1</span> <span class="m">400</span> <span class="n">Bad</span> <span class="n">Request</span>
<span class="n">content</span><span class="p">-</span><span class="n">type</span><span class="p">:</span> <span class="n">application</span><span class="p">/</span><span class="n">json</span><span class="p">;</span> <span class="n">charset</span><span class="p">=</span><span class="n">utf</span><span class="p">-</span><span class="m">8</span>

<span class="p">{</span>
  <span class="s">&quot;message&quot;</span><span class="p">:</span> <span class="s">&quot;Missing/invalid parameters&quot;</span><span class="p">,</span>
  <span class="s">&quot;params&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;age&quot;</span><span class="p">,</span>
      <span class="s">&quot;type&quot;</span><span class="p">:</span> <span class="s">&quot;query&quot;</span><span class="p">,</span>
      <span class="s">&quot;datatype&quot;</span><span class="p">:</span> <span class="s">&quot;integer&quot;</span><span class="p">,</span>
      <span class="s">&quot;required&quot;</span><span class="p">:</span> <span class="k">true</span><span class="p">,</span>
      <span class="s">&quot;reason&quot;</span><span class="p">:</span> <span class="s">&quot;Missing&quot;</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre></div>


<p>We can see the updated OpenApi UI <strong><a target="_blank" href="https://www.http4k.org/openapi3/?url=https%3A%2F%2Fraw.githubusercontent.com%2Fhttp4k%2Fhttp4k%2Fmaster%2Fsrc%2Fdocs%2Ftutorials%2Fdocumenting_apis_with_openapi%2F3_openapi.json">here</a></strong>. Note that because request parameters are validated before sending, we cannot replicate the above invalid request in the UI.</p>
<h3 id="4-modelling-http-body-messages">4. Modelling HTTP body messages</h3>
<p>The most exciting part http4k supporting OpenApi3 is the ability to represent HTTP messages in <strong><a href="https://json-schema.org/">JSON Schema</a></strong> form in the documentation. This facility is what unlocks the true cross-language support and takes the usefulness of the OpenApi UI to another level, for both exploratory and support functions. Request and response messages can both be specified in the <code>meta {}</code> block using overloads of the <code>receiving()</code> and <code>returning()</code> functions. By using these functions, we can supply an example object to the DSL - this is what drives the generation of the JSON Schema and, more importantly, ensures that the documentation cannot go stale as it is driven by code.</p>
<p>Lets add another route to the mix which returns a JSON body object modelled with a Kotlin Data class and once again using the <strong><a href="https://www.http4k.org/guide/modules/core/#typesafe-parameter-destructuringconstruction-of-http-messages-with-lenses">http4k Lens API</a></strong>. Here, the lens not only provides the validating (de)serialisation mechanism, but also activates the <code>Content-Type</code> header injection and parsing behaviour - this will ensure that all incoming and outgoing messages have the correct headers. </p>
<p>For JSON bodies, the lens is created with <code>Body.auto&lt;&gt;().toLens()</code> (<code>auto()</code> is an extension function imported from <code>Jackson</code>) which provides the typed injection and extraction functions. Notice here that for injection we are using the more fluent API  <code>with()</code> and <code>of()</code> extension functions, as opposed to the standard lens injection function<code>(X, HttpMessage) -&gt; HttpMessage</code>:</p>
<p>```kotlin
package tutorials.documenting_apis_with_openapi</p>
<p>import org.http4k.contract.ContractRoute
import org.http4k.contract.Tag
import org.http4k.contract.div
import org.http4k.contract.meta
import org.http4k.core.Body
import org.http4k.core.HttpHandler
import org.http4k.core.Method.GET
import org.http4k.core.Response
import org.http4k.core.Status.Companion.NOT_FOUND
import org.http4k.core.Status.Companion.OK
import org.http4k.core.with
import org.http4k.format.Jackson.auto
import org.http4k.lens.Path</p>
<p>data class Person(val name: String, val age: Age, val children: List<Person> = emptyList())</p>
<p>fun Family(): ContractRoute {</p>
<div class="codehilite"><pre><span></span><code><span class="n">val</span> <span class="n">familyData</span> <span class="o">=</span> <span class="n">Person</span><span class="p">(</span><span class="ss">&quot;Bob&quot;</span><span class="p">,</span> <span class="n">Age</span><span class="p">(</span><span class="mi">85</span><span class="p">),</span> <span class="n">listOf</span><span class="p">(</span>
    <span class="n">Person</span><span class="p">(</span><span class="ss">&quot;Anita&quot;</span><span class="p">,</span> <span class="n">Age</span><span class="p">(</span><span class="mi">55</span><span class="p">)),</span>
    <span class="n">Person</span><span class="p">(</span><span class="ss">&quot;Donald&quot;</span><span class="p">,</span> <span class="n">Age</span><span class="p">(</span><span class="mi">52</span><span class="p">),</span> <span class="n">listOf</span><span class="p">(</span><span class="n">Person</span><span class="p">(</span><span class="ss">&quot;Don Jr&quot;</span><span class="p">,</span> <span class="n">Age</span><span class="p">(</span><span class="mi">21</span><span class="p">))))</span>
<span class="p">))</span>

<span class="n">val</span> <span class="n">responseLens</span> <span class="o">=</span> <span class="n">Body</span><span class="p">.</span><span class="n">auto</span><span class="o">&lt;</span><span class="n">Person</span><span class="o">&gt;</span><span class="p">(</span><span class="ss">&quot;The matched family tree&quot;</span><span class="p">).</span><span class="n">toLens</span><span class="p">()</span>

<span class="n">fun</span> <span class="k">handler</span><span class="p">(</span><span class="n">queryName</span><span class="p">:</span> <span class="n">String</span><span class="p">):</span> <span class="n">HttpHandler</span> <span class="o">=</span> <span class="err">{</span>
    <span class="n">fun</span> <span class="n">Person</span><span class="p">.</span><span class="k">search</span><span class="p">():</span> <span class="n">Person</span><span class="o">?</span> <span class="o">=</span> <span class="k">when</span> <span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="err">{</span>
        <span class="n">queryName</span> <span class="o">-&gt;</span> <span class="n">this</span>
        <span class="k">else</span> <span class="o">-&gt;</span> <span class="n">children</span><span class="p">.</span><span class="n">firstOrNull</span> <span class="err">{</span> <span class="n">it</span><span class="p">.</span><span class="k">search</span><span class="p">()</span> <span class="o">!=</span> <span class="k">null</span> <span class="err">}</span>
    <span class="err">}</span>

    <span class="n">familyData</span><span class="p">.</span><span class="k">search</span><span class="p">()</span><span class="o">?</span><span class="p">.</span><span class="n">let</span> <span class="err">{</span> <span class="n">Response</span><span class="p">(</span><span class="n">OK</span><span class="p">).</span><span class="k">with</span><span class="p">(</span><span class="n">responseLens</span> <span class="k">of</span> <span class="n">it</span><span class="p">)</span> <span class="err">}</span> <span class="o">?</span><span class="p">:</span> <span class="n">Response</span><span class="p">(</span><span class="n">NOT_FOUND</span><span class="p">)</span>
<span class="err">}</span>

<span class="k">return</span> <span class="ss">&quot;/search&quot;</span> <span class="o">/</span> <span class="n">Path</span><span class="p">.</span><span class="k">of</span><span class="p">(</span><span class="ss">&quot;name&quot;</span><span class="p">,</span> <span class="ss">&quot;The name to search for in the tree&quot;</span><span class="p">)</span> <span class="n">meta</span> <span class="err">{</span>
    <span class="n">summary</span> <span class="o">=</span> <span class="ss">&quot;Search family tree&quot;</span>
    <span class="n">description</span> <span class="o">=</span> <span class="ss">&quot;Given a name, returns a sub family tree starting with that person&quot;</span>
    <span class="n">tags</span> <span class="o">+=</span> <span class="n">Tag</span><span class="p">(</span><span class="ss">&quot;query&quot;</span><span class="p">)</span>
    <span class="n">returning</span><span class="p">(</span><span class="n">OK</span><span class="p">,</span> <span class="n">responseLens</span> <span class="k">to</span> <span class="n">Person</span><span class="p">(</span><span class="ss">&quot;Donald&quot;</span><span class="p">,</span> <span class="n">Age</span><span class="p">(</span><span class="mi">52</span><span class="p">),</span> <span class="n">listOf</span><span class="p">(</span><span class="n">Person</span><span class="p">(</span><span class="ss">&quot;Don Jr&quot;</span><span class="p">,</span> <span class="n">Age</span><span class="p">(</span><span class="mi">21</span><span class="p">)))),</span> <span class="ss">&quot;Cut down family tree&quot;</span><span class="p">)</span>
    <span class="n">returning</span><span class="p">(</span><span class="n">NOT_FOUND</span> <span class="k">to</span> <span class="ss">&quot;That person does not exist the family&quot;</span><span class="p">)</span>
<span class="err">}</span> <span class="n">bindContract</span> <span class="k">GET</span> <span class="k">to</span> <span class="p">::</span><span class="k">handler</span>
</code></pre></div>


<p>}```</p>
<p>Taking a final look at the OpenApi UI <strong><a target="_blank" href="https://www.http4k.org/openapi3/?url=https%3A%2F%2Fraw.githubusercontent.com%2Fhttp4k%2Fhttp4k%2Fmaster%2Fsrc%2Fdocs%2Ftutorials%2Fdocumenting_apis_with_openapi%2F4_openapi.json">here</a></strong> shows that not just has the UI been updated with the new route, but that example entries for the expected response are now displayed, as well as JSON Schema entries for the <code>Person</code> and <code>Age</code> classes in the <code>Schemas</code> section at the bottom.</p>
<h3 id="wrapping-up">Wrapping up...</h3>
<p>Once we have the final specification document available, users of our API can use the various <strong><a href="https://openapi-generator.tech">OpenApi Generators</a></strong> to generate HTTP clients in various languages for interacting with it, or to generate fake services that provide our API in their own environments (and thus enabling more simple end-to-end testing). The "Fake HTTP services" technique also enables the creation of Consumer-Driven-Contract style tests, and opens up possibilities for all kinds of interesting Chaos/failure-mode testing (you can even use the <code>http4k-testing-chaos</code> module to help with this 😉).</p>
<p>The full source for this tutorial can be found <strong><a href="https://github.com/http4k/http4k/tree/master/src/docs/tutorials/documenting_apis_with_openapi/">here</a></strong>, or for a sense of how this all looks in when mixed into a complete http4k project, check out the <strong><a href="https://github.com/http4k/http4k-by-example">http4k-by-example</a></strong> repo, which contains an entire TDD'd project showcasing a multitude of http4k features and testing styles.</p>
                    
                    
                    
                    
                    
                    


                    
                </article>
            </div>
        </div>
    </main>
    
    
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../tdding_http4k/" title="TDDing http4k" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                TDDing http4k
              </span>
            </div>
          </a>
        
        
          <a href="../../cookbook/server_as_a_function/" title="Server as a function" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Server as a function
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020 - David Denton (@daviddenton), IvanSanchez (@s4nchez)
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
    
</div>

      <script src="../../assets/javascripts/application.583bbe55.js"></script>

<script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>




<script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-125143867-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>


</body>
</html>